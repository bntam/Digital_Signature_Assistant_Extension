<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BHYT 4210 - Danh s√°ch thu·ªëc</title>
    <link rel="stylesheet" href="css/bhyt-4210.css">
</head>
<body>
    <div class="container">
        <header class="page-header">
            <h1>üìã B·∫£o Hi·ªÉm 4210 - Danh s√°ch thu·ªëc</h1>
            <div class="header-actions">
                <button id="manageMedicineDataBtn" class="btn btn-info" style="margin-right: 10px;">
                    <span class="icon">‚öôÔ∏è</span> Qu·∫£n l√Ω d·ªØ li·ªáu thu·ªëc
                </button>
                <button id="backBtn" class="btn btn-secondary">
                    <span class="icon">‚Üê</span> Quay l·∫°i
                </button>
            </div>
        </header>

        <main class="main-content">
            <!-- Filter Section -->
            <section class="filter-section">
                <div class="filter-group">
                    <label for="dateFrom">T·ª´ ng√†y:</label>
                    <input 
                        type="text" 
                        id="dateFrom" 
                        class="form-input"
                        placeholder="DD/MM/YYYY HH:mm:ss"
                    />
                </div>
                <div class="filter-group">
                    <label for="dateTo">ƒê·∫øn ng√†y:</label>
                    <input 
                        type="text" 
                        id="dateTo" 
                        class="form-input"
                        placeholder="DD/MM/YYYY HH:mm:ss"
                    />
                </div>
                <button id="searchBtn" class="btn btn-primary">
                    <span class="icon">üîç</span> T√¨m ki·∫øm
                </button>
                <button id="searchAIBtn" class="btn btn-success" style="margin-left: 10px; display: none;">
                    <span class="icon">ü§ñ</span> T√¨m ki·∫øm AI
                </button>
            </section>

            <!-- Progress Section -->
            <div id="progressSection" class="progress-section" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-info">
                    <span id="progressText">ƒêang x·ª≠ l√Ω...</span>
                    <span id="progressStatus"></span>
                </div>
            </div>

            <!-- Results Section -->
            <section class="results-section">
                <div class="section-header">
                    <h3>üìä K·∫øt qu·∫£</h3>
                    <div class="stats">
                        <span class="stat-item">
                            <span class="icon">üìù</span>
                            T·ªïng: <strong id="totalCount">0</strong>
                        </span>
                    </div>
                </div>

                <!-- Table Controls -->
                <div class="table-controls-wrapper">
                    <!-- First Row: Action Buttons and Filters -->
                    <div class="controls-row">
                        <div class="button-group">
                            <button id="expandAllBtn" class="btn btn-secondary btn-sm btn-icon-only" title="M·ªü r·ªông t·∫•t c·∫£">
                                <span class="icon">üìÇ</span>
                            </button>
                            <button id="collapseAllBtn" class="btn btn-secondary btn-sm btn-icon-only" title="Thu g·ªçn t·∫•t c·∫£">
                                <span class="icon">üìÅ</span>
                            </button>
                        </div>
                        
                        <!-- Filter Inputs -->
                        <div class="filter-inputs-group">
                            <input 
                                type="text" 
                                id="filterMaLKInput" 
                                placeholder="M√£ LK..."
                                class="filter-input-sm"
                            />
                            <input 
                                type="text" 
                                id="filterHoTenInput" 
                                placeholder="H·ªç t√™n..."
                                class="filter-input-sm"
                            />
                            <input 
                                type="text" 
                                id="filterMaBenhInput" 
                                placeholder="M√£ b·ªánh..."
                                class="filter-input-sm"
                            />
                            <div class="multi-select-wrapper">
                                <div class="multi-select-input" id="maBacSiMultiSelect" tabindex="0">
                                    <span class="placeholder">Ch·ªçn b√°c sƒ©...</span>
                                    <span class="arrow">‚ñº</span>
                                </div>
                                <div class="multi-select-dropdown" id="maBacSiDropdown" style="display: none;">
                                    <div class="multi-select-search">
                                        <input type="text" id="customMaBacSiInput" placeholder="Nh·∫≠p m√£ b√°c sƒ©..." />
                                        <button id="addCustomMaBacSiBtn" class="btn btn-sm btn-primary">Th√™m</button>
                                    </div>
                                    <div class="multi-select-options">
                                        <label class="multi-select-option">
                                            <input type="checkbox" value="0002242" data-name="Bs H∆∞∆°ng" />
                                            <span>Bs H∆∞∆°ng (0002242)</span>
                                        </label>
                                        <label class="multi-select-option">
                                            <input type="checkbox" value="003544" data-name="Bs Qu·ª≥nh" />
                                            <span>Bs Qu·ª≥nh (003544)</span>
                                        </label>
                                        <label class="multi-select-option">
                                            <input type="checkbox" value="0001090" data-name="Bs Th·ªßy" />
                                            <span>Bs Th·ªßy (0001090)</span>
                                        </label>
                                        <label class="multi-select-option">
                                            <input type="checkbox" value="000456" data-name="Bs Lam" />
                                            <span>Bs Lam (000456)</span>
                                        </label>
                                        <label class="multi-select-option">
                                            <input type="checkbox" value="0011114" data-name="Bs Trung" />
                                            <span>Bs Trung (0011114)</span>
                                        </label>
                                        <label class="multi-select-option">
                                            <input type="checkbox" value="003366" data-name="Bs Th∆∞" />
                                            <span>Bs Th∆∞ (003366)</span>
                                        </label>
                                        <label class="multi-select-option">
                                            <input type="checkbox" value="03130" data-name="Bs H√¢n" />
                                            <span>Bs H√¢n (03130)</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <button id="clearFilterBtn" class="btn btn-secondary btn-sm btn-icon-only" title="X√≥a b·ªô l·ªçc">
                                <span class="icon">‚úñ</span>
                            </button>
                        </div>
                        
                        <!-- Checkboxes in vertical column -->
                        <div class="checkboxes-column">
                            <label class="checkbox-label">
                                <input type="checkbox" id="showInvalidOnlyCheckbox" />
                                <span class="checkbox-text invalid">üö´ Ch·ªâ hi·ªÉn th·ªã b·ªánh nh√¢n c√≥ thu·ªëc kh√¥ng h·ª£p l·ªá</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="hideNotFoundMedicinesCheckbox" />
                                <span class="checkbox-text">üëª ·∫®n thu·ªëc kh√¥ng t√¨m th·∫•y trong danh m·ª•c</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table id="resultsTable" class="data-table">
                        <thead>
                            <tr>
                                <th class="col-stt">STT</th>
                                <th class="col-ma-lk sortable" data-column="MA_LK">
                                    M√£ LK <span class="sort-icon">‚áÖ</span>
                                </th>
                                <th class="col-ho-ten sortable" data-column="HO_TEN">
                                    H·ªç t√™n <span class="sort-icon">‚áÖ</span>
                                </th>
                                <th class="col-benh-chinh">M√£ b·ªánh ch√≠nh</th>
                                <th class="col-benh-kt">M√£ b·ªánh KT</th>
                                <th class="col-ma-bac-si sortable" data-column="MA_BAC_SI">
                                    M√£ b√°c sƒ© <span class="sort-icon">‚áÖ</span>
                                </th>
                                <th class="col-ma-thuoc" style="display: none;">M√£ thu·ªëc</th>
                                <th class="col-tong-thuoc sortable" data-column="TOTAL_MEDICINES" style="text-align: center;">
                                    T·ªïng s·ªë thu·ªëc <span class="sort-icon">‚áÖ</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="resultsTableBody">
                            <tr class="empty-row">
                                <td colspan="8" class="empty-state">
                                    Ch·ªçn kho·∫£ng th·ªùi gian v√† click T√¨m ki·∫øm ƒë·ªÉ xem k·∫øt qu·∫£
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Notification System -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Medicine Data Editor Modal -->
    <div id="medicineDataModal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>‚öôÔ∏è Qu·∫£n l√Ω d·ªØ li·ªáu thu·ªëc</h2>
                <button class="modal-close" onclick="bhyt4210.closeMedicineDataModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="editor-toolbar">
                    <button id="addMedicineBtn" class="btn btn-success btn-sm">
                        <span class="icon">‚ûï</span> Th√™m thu·ªëc
                    </button>
                    <button id="saveMedicineDataBtn" class="btn btn-primary btn-sm">
                        <span class="icon">üíæ</span> L∆∞u thay ƒë·ªïi
                    </button>
                    <span class="editor-info">T·ªïng: <strong id="medicineCount">0</strong> thu·ªëc</span>
                </div>
                <div class="table-container" style="max-height: 60vh; overflow: auto;">
                    <table id="medicineDataTable" class="data-table editor-table">
                        <thead style="position: sticky; top: 0; z-index: 10; background: #f8f9fa;">
                            <tr>
                                <th style="width: 50px;">STT</th>
                                <th style="width: 250px;">T√™n thu·ªëc</th>
                                <th style="width: 300px;">ICD Ch·ªâ ƒë·ªãnh</th>
                                <th style="width: 300px;">ICD Ch·ªëng ch·ªâ ƒë·ªãnh</th>
                                <th style="width: 80px;">Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="medicineDataBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/api-service.js"></script>
    <script src="js/ai-validation-service.js"></script>
    <script src="js/bhyt-4210.js"></script>
</body>
</html>
